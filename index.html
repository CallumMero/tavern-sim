<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tavern Sim</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="scanline"></div>
  <div id="bootWarning" class="boot-warning hidden" role="alert"></div>
  <div id="menuRoot" class="menu-root" aria-live="polite">
    <section class="menu-panel" data-menu-screen="main_menu" aria-label="Main Menu">
      <div class="menu-logo-wrap">
        <div class="menu-logo-plaque">
          <p class="menu-logo-kicker">Kingdom Of Calvador</p>
          <h1 class="menu-logo-title">Tavern Simulator</h1>
          <p class="menu-logo-subtitle">Warm Hearths, Sharp Ledgers</p>
        </div>
      </div>
      <div class="menu-actions">
        <button id="menuPlayBtn" class="menu-btn primary">Play</button>
        <button id="menuSettingsBtn" class="menu-btn">Settings</button>
        <button id="menuContinueBtn" class="menu-btn">Continue</button>
        <p id="menuContinueMeta" class="menu-note"></p>
      </div>
    </section>

    <section class="menu-panel hidden" data-menu-screen="new_campaign_location_select" aria-label="Location Select">
      <h2 class="menu-heading">Choose Your Opening Location</h2>
      <p class="menu-note">Select where your tavern begins in the Kingdom of Calvador.</p>
      <div id="menuLocationCards" class="location-card-grid"></div>
      <label for="menuSeedInput" class="field-label">Seed (optional)</label>
      <input id="menuSeedInput" type="text" inputmode="numeric" placeholder="Random if blank">
      <div class="menu-actions inline">
        <button id="menuStartCampaignBtn" class="menu-btn primary">Start Campaign</button>
        <button id="menuBackFromLocationBtn" class="menu-btn">Back</button>
      </div>
    </section>

    <section class="menu-panel hidden" data-menu-screen="settings_menu" aria-label="Settings">
      <h2 class="menu-heading">Settings</h2>
      <p class="menu-note">Foundational settings for menu and UI presentation.</p>

      <label for="menuAudioModeSelect" class="field-label">Audio Mode</label>
      <select id="menuAudioModeSelect">
        <option value="hearth_only">Hearth Ambience (Placeholder)</option>
        <option value="muted">Muted</option>
      </select>

      <label for="menuUiScaleSelect" class="field-label">UI Scale</label>
      <select id="menuUiScaleSelect">
        <option value="0.9">Compact</option>
        <option value="1">Default</option>
        <option value="1.1">Large</option>
      </select>

      <label for="menuTextSizeSelect" class="field-label">Text Size</label>
      <select id="menuTextSizeSelect">
        <option value="compact">Compact</option>
        <option value="default">Default</option>
        <option value="large">Large</option>
      </select>

      <label for="menuDefaultSpeedSelect" class="field-label">Default Simulation Speed</label>
      <select id="menuDefaultSpeedSelect">
        <option value="0">Pause</option>
        <option value="1">Play</option>
        <option value="2">Fast x2</option>
        <option value="4">Fast x4</option>
      </select>

      <div class="menu-actions inline">
        <button id="menuBackFromSettingsBtn" class="menu-btn">Back</button>
      </div>
    </section>
  </div>

  <main class="app-shell" id="appShell">
    <header class="topbar panel">
      <div class="brand">
        <h1>TAVERN SIM</h1>
        <p>Kingdom Of Calvador Ledger</p>
      </div>
      <div class="top-stats" id="topStats"></div>
    </header>

    <section class="grid">
      <aside class="panel col left">
        <h2>Operations</h2>
        <div class="group">
          <h3>Campaign Setup</h3>
          <label for="startLocationSelect" class="field-label">Opening Location</label>
          <select id="startLocationSelect"></select>
          <label for="startSeedInput" class="field-label">Seed (optional)</label>
          <input id="startSeedInput" type="text" inputmode="numeric" placeholder="Random if blank">
          <button id="startCampaignBtn">Start New Campaign</button>
        </div>

        <div class="group">
          <h3>District Travel</h3>
          <div id="districtStatusView" class="report-list compact"></div>
          <label for="travelDestinationSelect" class="field-label">Travel Destination</label>
          <select id="travelDestinationSelect"></select>
          <button id="travelBtn">Begin District Travel</button>
        </div>

        <div class="group">
          <h3>Crown Compliance</h3>
          <div id="crownStatusView" class="report-list compact"></div>
          <button id="fileComplianceBtn">File Voluntary Report</button>
          <button id="settleArrearsBtn">Settle Crown Arrears</button>
        </div>

        <div class="group">
          <h3>Supplier Network</h3>
          <div id="supplierStatusView" class="report-list compact"></div>
          <button id="signLocalContractBtn">Sign Local Broker Contract</button>
          <button id="signWholesaleContractBtn">Sign Arcanum Wholesale Contract</button>
          <button id="stockRunBtn">Dispatch City Stock-Up Run</button>
        </div>

        <div class="group">
          <h3>Production</h3>
          <button id="brewAleBtn">Brew Ale</button>
          <button id="brewMeadBtn">Brew Mead</button>
          <button id="cookStewBtn">Cook Stew</button>
          <button id="cleanBtn">Deep Clean</button>
          <button id="repairBtn">Repair Tavern</button>
        </div>

        <div class="group">
          <h3>Supplies</h3>
          <button id="buyGrainBtn">Buy Grain</button>
          <button id="buyHopsBtn">Buy Hops</button>
          <button id="buyHoneyBtn">Buy Honey</button>
          <button id="buyMeatBtn">Buy Meat</button>
          <button id="buyVegBtn">Buy Vegetables</button>
          <button id="buyBreadBtn">Buy Bread</button>
          <button id="buyWoodBtn">Buy Firewood</button>
        </div>
      </aside>

      <section class="panel col center">
        <h2>Ledger And Control</h2>

        <div class="scene-shell">
          <canvas
            id="sceneCanvas"
            width="320"
            height="180"
            role="img"
            aria-label="Pixel tavern preview"
          ></canvas>
          <p class="scene-caption">Live pixel preview driven by the simulation engine.</p>
        </div>

        <div class="summary-grid">
          <div>
            <h3>Inventory</h3>
            <div id="inventoryView" class="kv-list"></div>
          </div>
          <div>
            <h3>Price Board</h3>
            <div id="priceView" class="price-list"></div>
          </div>
        </div>

        <div class="group">
          <h3>Simulation Clock</h3>
          <div id="clockStatusView" class="report-list compact"></div>
          <div class="group inline">
            <button id="pauseSimBtn">Pause</button>
            <button id="playSimBtn">Play</button>
            <button id="fast2SimBtn">Fast Forward x2</button>
            <button id="fast4SimBtn">Fast Forward x4</button>
          </div>
        </div>

        <div class="group">
          <h3>Weekly Planning Board</h3>
          <div id="planningStatusView" class="report-list compact"></div>
          <label for="planStaffingSelect" class="field-label">Staffing Intent</label>
          <select id="planStaffingSelect">
            <option value="balanced">Balanced</option>
            <option value="rest_focus">Rest Focus</option>
            <option value="training_push">Training Push</option>
          </select>
          <label for="planPricingSelect" class="field-label">Pricing Intent</label>
          <select id="planPricingSelect">
            <option value="value">Value</option>
            <option value="balanced">Balanced</option>
            <option value="premium">Premium</option>
          </select>
          <label for="planProcurementSelect" class="field-label">Procurement Intent</label>
          <select id="planProcurementSelect">
            <option value="stability">Stability</option>
            <option value="quality">Quality</option>
            <option value="cost_control">Cost Control</option>
          </select>
          <label for="planMarketingSelect" class="field-label">Marketing Intent</label>
          <select id="planMarketingSelect">
            <option value="steady">Steady</option>
            <option value="growth">Growth</option>
            <option value="campaign">Campaign</option>
          </select>
          <label for="planLogisticsSelect" class="field-label">Logistics Intent</label>
          <select id="planLogisticsSelect">
            <option value="local">Local</option>
            <option value="caravan_watch">Caravan Watch</option>
            <option value="city_push">City Push</option>
          </select>
          <label for="planRiskSelect" class="field-label">Risk Tolerance</label>
          <select id="planRiskSelect">
            <option value="low">Low</option>
            <option value="moderate">Moderate</option>
            <option value="high">High</option>
          </select>
          <label for="planReserveInput" class="field-label">Reserve Gold Target</label>
          <input id="planReserveInput" type="number" min="0" step="1" value="100">
          <label for="planNoteInput" class="field-label">Planning Note</label>
          <input id="planNoteInput" type="text" maxlength="140" placeholder="Week focus">
          <div class="group inline">
            <button id="updatePlanDraftBtn">Update Weekly Draft</button>
            <button id="commitPlanBtn">Commit Weekly Plan</button>
          </div>
        </div>

        <div class="group">
          <h3>Command Board</h3>
          <div id="commandBoardView" class="report-list compact"></div>
        </div>

        <div class="group">
          <h3>Delegation Desk</h3>
          <div id="delegationView" class="report-list compact"></div>
        </div>

        <div class="group inline">
          <button id="trainBtn">Train Staff</button>
          <button id="marketingBtn">Run Marketing</button>
          <button id="festivalBtn">Host Minstrel Night</button>
          <button id="nextDayBtn" class="primary">Skip To Next Day</button>
        </div>

        <h3>Daily Reports</h3>
        <div id="reportView" class="report-list"></div>

        <h3>Daily Log</h3>
        <div id="logView" class="log"></div>
      </section>

      <aside class="panel col right">
        <h2>People</h2>
        <div class="group">
          <h3>Staff</h3>
          <div id="staffView" class="staff-list"></div>
          <button id="hireServerBtn">Hire Server</button>
          <button id="hireCookBtn">Hire Cook</button>
          <button id="hireBarkeepBtn">Hire Barkeep</button>
          <button id="hireGuardBtn">Hire Guard</button>
        </div>

        <div class="group">
          <h3>Rota Presets</h3>
          <button id="rotaBalancedBtn">Balanced Rota</button>
          <button id="rotaDayBtn">Day Heavy Rota</button>
          <button id="rotaNightBtn">Night Heavy Rota</button>
        </div>

        <div class="group">
          <h3>World Influence</h3>
          <div id="worldActorsView" class="kv-list"></div>
        </div>

        <div class="group">
          <h3>Analytics Dashboard</h3>
          <div id="analyticsView" class="report-list compact"></div>
        </div>

        <div class="group">
          <h3>Scouting And Rumors</h3>
          <div id="scoutingView" class="report-list compact"></div>
        </div>
      </aside>
    </section>
  </main>

  <script>
    (function () {
      const warningEl = document.getElementById("bootWarning");
      if (!warningEl) {
        return;
      }

      function showWarning(message) {
        warningEl.textContent = message;
        warningEl.classList.remove("hidden");
      }

      if (window.location.protocol === "file:") {
        showWarning(
          "Local file mode detected. Run a local server (for example: python -m http.server 4173) and open http://127.0.0.1:4173/index.html."
        );
      }

      window.setTimeout(() => {
        if (!window.__tavernAppStarted) {
          showWarning(
            "Game scripts did not finish booting. Serve the project over http://localhost (not file://)."
          );
        }
      }, 1400);
    })();
  </script>

  <script type="module" src="src/main.js"></script>
</body>
</html>
